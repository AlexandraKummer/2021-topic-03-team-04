---
title: "Alex Code"
author: "Alex"
date: "1 5 2021"
output: html_document
---
Loading packages
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

Creating plot: total protein in control vs fraction, rep1= blue, rep2= red, rep3= blue
```{r}
library("ggplot2")
library("tidyverse")

Total_Prot_Rotated <- t(Total_Protein_Data)
Total_Prot_Rotated_df <- data.frame(Total_Prot_Rotated)

ggplot(Total_Prot_Rotated_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_Rotated_df[,1]),colour="blue", label="Ctrl_Rep_1")+
  geom_line(aes(y=Total_Prot_Rotated_df[,2]), colour="red", label="Ctrl_Rep_2")+
  geom_line(aes(y=Total_Prot_Rotated_df[,3]), colour = "darkgreen", label = "Ctrl_Rep_3")+
  ggtitle("Total protein amount of control repetition in every fraction")+
  xlab("Fraction")+
  ylab("Protein Amount")+
  theme(legend.position = "right")+
  scale_x_continuous(breaks=1:25)
```

Creating plot: total protein in RNAse vs fraction, rep1= blue, rep2= red, rep3= blue

```{r}
ggplot(Total_Prot_Rotated_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_Rotated_df[,4]),colour="blue")+
  geom_line(aes(y=Total_Prot_Rotated_df[,5]), colour="red")+
  geom_line(aes(y=Total_Prot_Rotated_df[,6]), colour = "darkgreen")+
  scale_x_continuous(breaks=1:25)+
  ggtitle("Total protein amount of RNAse repetitions in every fraction")+
  ylab("Protein amount")+
  xlab("Fraction")
```
Creating plot: total mean protein in RNAse & Ctrl vs fraction, RNAse = red, Ctrl = blue

```{r}
Total_Prot_Rotated_mean_df <- Total_Prot_Rotated_df %>%
  mutate(mean_Ctrl = rowMeans(Total_Prot_Rotated_df[,1:3]))%>%
  mutate(mean_RNAse = rowMeans(Total_Prot_Rotated_df[,4:6]))
ggplot(Total_Prot_Rotated_mean_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_Rotated_mean_df[,7]), color = "blue")+
  geom_line(aes(y=Total_Prot_Rotated_mean_df[,8]), color = "red")+
  ggtitle("Comparison of total protein amount of control and RNAse")+
  xlab("Fraction")+
  ylab("Protein amount")+
  scale_x_continuous(breaks = 1:25)
```


```{r}
barplot(Total_Protein_Sum, ylab = "Protein amount", las = 2, cex.axis=0.5, cex.names=0.8, main = "Total Protein amount of repetitions")
Total_Protein_Sum
```
```{r}
ggplot(Total_Prot_norm_Rotated_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,4]),colour="blue")+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,5]), colour="red")+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,6]), colour = "darkgreen")+
  scale_x_continuous(breaks=1:25)+
  ggtitle("Normalized protein amount of RNAse repetitions in every fraction")+
  ylab("Protein amount")+
  xlab("Fraction")

ggplot(Total_Prot_norm_Rotated_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,1]),colour="blue")+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,2]), colour="red")+
  geom_line(aes(y=Total_Prot_norm_Rotated_df[,3]), colour = "darkgreen")+
  scale_x_continuous(breaks=1:25)+
  ggtitle("Normalized protein amount of control repetitions in every fraction")+
  ylab("Protein amount")+
  xlab("Fraction")
```


Maxima Detection:
Ähnlich zu Izars function, bloß gibt diese hier direkt einen Vektor mit der länge der gefundenen Maxima aus. 
noch kein Thresholding enthalten
```{r}
test_vert <-c(10,13,30,25,80,65,50,40,20,20,30,40,30,35,50,30,20,10,30,20,40,30,20,20,10)
plot(1:25,test_vert, type="l")
max_detection <- function(Input_Data){
  pos_vec <- numeric()
  while (i <= 25){
    if (i == 1){
      if(Input_Data[i] > input_Data[i+1]){
        pos_vec <- c(pos_vec, i)
      }
    }
    if (i < 25){
      if(Input_Data[i]>Input_Data[i+1] && Input_Data[i]> Input_Data[i-1]){
        pos_vec <- c(pos_vec, i)
      }
    }
    if (i==25){
      if(Input_Data[i]>Input_Data[i-1]){
        pos_vec <- c(pos_vec, i)
      }
    }
    i=i+1
  }
  return(pos_vec)
}

test_lauf <- max_detection(test_vert)

#in diesem environment ist test_lauf komischer weise ein leerer vektor. Der 1zu1 kopierte code funktioniert in meinem rumprobier environment wunderbar.und gibt einen vektor mit 6 elementen (3,5,12,15,19,21)


```



Jetzt möchte ich versuchen, dass man die Maxima detection gleich auf ein Dataframe anwenden kann und dieses nicht erst in lauter Vectoren übertragen muss, auf die man einzeln die Function anwenden müsste
```{r}
test_matrix <- matrix(rep(test_vert, 3), byrow=TRUE, nrow=3, ncol=25)
test_df <- data.frame(test_matrix)


max_detec_df <- function(Input_df){
  j=1
  temp_matrix <- matrix(nrow=dim(Input_df)[1], ncol = dim(Input_df)[2])#leere matrix
  temp_vec <- numeric()#leerer vektor
  for (j in 1:dim(Input_df)[1]){#j soll die nummer der Zeile annehmen, um auf die Zeile im if statement zuzugreifen
   while (i <= 1:dim(Input_df)[2]){#für eine Zeile weren alle spalten durchgetestet
    if (i == 1){#für die erste spalte, die nur rechts ein vergleichselement hat
      if(Input_df[j,i] > Input_df[j,i+1]){
        temp_vec <-c(temp_vec,i)#hier soll der leere Vektor als neues element die stelle des maximus bekommen
      }else{
        temp_vec <- c(temp_vec, 0)#wenn stelle nicht eingesetzt soll der Wert 0 rein, damit der Vektor weiterhin 25 elemente hat
      }
    }
    if (i < dim(Input_df)[2]&& i!=1){
      if(Input_df[j,i]>Input_df[j,i+1] && Input_df[j,i]> Input_df[j,i-1]){
        temp_vec <- c(temp_vec, i)
      }else {
        temp_vec <- c(temp_vec, 0)
      }
    }
    if (i == dim(Input_df)[2]){
      if(Input_df[j,i]>Input_df[j,i-1]){
        temp_vec <- c(temp_vec, i)
      }else{
          temp_vec <- c(temp_vec, 0)
        }
      }
    i=i+1
    }#nachdem der vektor für eine Zeile fertig ist, soll er in die entsprechenden Zeile der Matrixgefüllt werden
    (temp_matrix[j,]<-temp_vec)
  }#j wird jetzt um 1 erhöht, der temp_vec wird mit den locations aus der neuen Zeile überschrieben und dann in die nächste Zeile der Matrix gefüllt
  return(temp_matrix)#am Ende soll eine Martrix entstehen, die für jedes Protein den Vektor enthält
  
}

test_lauf_zwei <- max_detec_df(test_df)#code läuft nicht, ist also kot lul. irgendeine bedingung hat Länge > 1 und das füllen der MAtrix gibt Ersetzung hat die Länge 0
```
