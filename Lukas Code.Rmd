---
title: "First Attempt"
author: "Lukas"
date: "19 4 2021"
output: html_document
---
Loading the data and the libraries.
```{r}
Raw_Data<- read.table("c://Data_Analysis//RDeeP_A549_NS.csv", header=TRUE, row.names=1, sep = ";")

library("tidyverse")
library("dplyr")
library("ggplot2")

Data_copy = Raw_Data

```
Reihenfolge der Columns: Aufgeteilt nach Fractions -> Ctrl_Rep1, RNAse_Rep1, Ctrl_Rep2,RNAse_Rep2, usw. also Fractions und dann wechselnd Ctrl und RNAse durch alle 3 Repetitions durch.

In dem unterstehenden Chunk will ich: 2 dataframes erstellen mit 3x3680 Zeilen und 25 spalten, wo einmal alle CTRl repetitions und einmal alle RNAse repititons als eigene zeile drin sind und die Spalten den 25 fractions entsprechen.

Zeile X in der Raw data entspricht nun Zeilen X*3-2 bis X*3 im neuen Dataset


```{r}
Ctrl_Matrix = matrix(nrow = 3*3680, ncol=25)
 
k = 1 ## für die Zeilen in der Raw Tabelle.
k_counter = 0 ##Für die Repetition die Gerade betrachtet wird (1,2 oder 3)
for (i in 1:dim(Ctrl_Matrix)[1]) { ##Für die Zeilen in der Neuen Matrix
  if (k_counter == 3){ ##Für Je 3 Zeilen in der alten Matrix wird 3 mal die selbe Zeile aus dem Raw dataframe verwendet.
    k = k + 1
    k_counter = 1
  } else {
    k_counter = k_counter + 1
  }
  
  if (k_counter == 0 | k_counter == 1 ) { ##Repetion 1
    j = 1
    l = 1
    while (j <= dim(Ctrl_Matrix)[2]) {
      Ctrl_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
  if (k_counter == 2) { ##Repetion 2
    j = 1
    l = 3
    while (j <= dim(Ctrl_Matrix)[2]) {
      Ctrl_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
  if (k_counter == 3) { ##Repetion 3
    j = 1
    l = 5
    while (j <= dim(Ctrl_Matrix)[2]) {
      Ctrl_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
  
}
Ctrl_Matrix[13:15,1:25]
Data_copy[5,]
```

Vergleich der Beiden Matritzen mit dem Original Dataset hat ergeben, dass die Umstrukturierung erfolg hatte.

```{r}
RNAse_Matrix = matrix(nrow = 3*3680, ncol=25)
 
k = 1 ## für die Zeilen in der Raw Tabelle.
k_counter = 0 ##Für die Repetition die Gerade betrachtet wird (1,2 oder 3)
for (i in 1:dim(RNAse_Matrix)[1]) { ##Für die Zeilen in der Neuen Matrix
  if (k_counter == 3){ ##Für Je 3 Zeilen in der alten Matrix wird 3 mal die selbe Zeile aus dem Raw dataframe verwendet.
    k = k + 1
    k_counter = 1
  } else {
    k_counter = k_counter + 1
  }
  
  if (k_counter == 0 | k_counter == 1 ) { ##Repetion 1
    j = 1
    l = 2
    while (j <= dim(RNAse_Matrix)[2]) {
      RNAse_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
  if (k_counter == 2) { ##Repetion 2
    j = 1
    l = 4
    while (j <= dim(RNAse_Matrix)[2]) { 
      RNAse_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
  if (k_counter == 3) { ##Repetion 3
    j = 1
    l = 6
    while (j <= dim(RNAse_Matrix)[2]) {
      RNAse_Matrix[i,j] = Data_copy[k,l]
      l = l + 6
      j = j + 1
    }
  }
}
```

Jetzt will ich aus meinen 2 Matrizen dataframes mit row und col names machen.

```{r}
##Ctrl Dataframe
Ctrl_Data = as.data.frame(Ctrl_Matrix)

#Colnames

for (i in 1:25) {
  s = paste("Fraction",i,sep="_")
  colnames(Ctrl_Data)[i] = s
}

#Rownames

k = 1 ## für die Zeilen in der Raw Tabelle.
k_counter = 0 ##Für die Repetition die Gerade betrachtet wird (1,2 oder 3)
for (i in 1:dim(Ctrl_Matrix)[1]) {
  if (k_counter == 3){ ##Für Je 3 Zeilen in der alten Matrix wird 3 mal die selbe Zeile aus dem Raw dataframe verwendet.
    k = k + 1
    k_counter = 1
  } else {
    k_counter = k_counter + 1
  }
  s = paste(rownames(Data_copy)[k],"Rep",k_counter,sep="_")
  rownames(Ctrl_Data)[i] = s
}

##RNAse Dataframe
RNAse_Data = as.data.frame(RNAse_Matrix)

#Colnames

for (i in 1:25) {
  s = paste("Fraction",i,sep="_")
  colnames(RNAse_Data)[i] = s
}

#Rownames

k = 1 ## für die Zeilen in der Raw Tabelle.
k_counter = 0 ##Für die Repetition die Gerade betrachtet wird (1,2 oder 3)
for (i in 1:dim(RNAse_Matrix)[1]) {
  if (k_counter == 3){ ##Für Je 3 Zeilen in der alten Matrix wird 3 mal die selbe Zeile aus dem Raw dataframe verwendet.
    k = k + 1
    k_counter = 1
  } else {
    k_counter = k_counter + 1
  }
  s = paste(rownames(Data_copy)[k],"Rep",k_counter,sep="_")
  rownames(RNAse_Data)[i] = s
}
RNAse_Data
Ctrl_Data
Data_copy

```

Ich will ein Dataframe mit 6 Zeilen und 25 Spalten wo eine Zeile jeweils dem Totalen Protein Gehalt in einer Repition entspricht (3 für RNAse und 3 für Kontrolle)
```{r}
Total_Protein = matrix(ncol=25,nrow=6)

for (j in 1:25) { # Alle Spalten werden durchgegangen
  k = 1          # K nummeriert die Spalte in Ctrl_Data bzw. RNAse_Date
  Protein_Sum = 0
  while (k <= dim(Ctrl_Data)[1]){
    Protein_Sum = Protein_Sum + Ctrl_Data[k,j] # Jede Dritte Zeile wird aufsummiert.
    k = k + 3
  }
  Total_Protein[1,j]=Protein_Sum
}
## Wiederholung des Ganzen für die übrigen 5 Zeilen
for (j in 1:25) {
  k = 2
  Protein_Sum = 0
  while (k <= dim(Ctrl_Data)[1]){
    Protein_Sum = Protein_Sum + Ctrl_Data[k,j]
    k = k + 3
  }
  Total_Protein[2,j]=Protein_Sum
}

for (j in 1:25) {
  k = 3
  Protein_Sum = 0
  while (k <= dim(Ctrl_Data)[1]){
    Protein_Sum = Protein_Sum + Ctrl_Data[k,j]
    k = k + 3
  }
  Total_Protein[3,j]=Protein_Sum
}
for (j in 1:25) { # Alle Spalten werden durchgegangen
  k = 1          # K nummeriert die Spalte in Ctrl_Data bzw. RNAse_Date
  Protein_Sum = 0
  while (k <= dim(RNAse_Data)[1]){
    Protein_Sum = Protein_Sum + RNAse_Data[k,j] # Jede Dritte Zeile wird aufsummiert.
    k = k + 3
  }
  Total_Protein[4,j]=Protein_Sum
}

for (j in 1:25) {
  k = 2
  Protein_Sum = 0
  while (k <= dim(RNAse_Data)[1]){
    Protein_Sum = Protein_Sum + RNAse_Data[k,j]
    k = k + 3
  }
  Total_Protein[5,j]=Protein_Sum
}

for (j in 1:25) {
  k = 3
  Protein_Sum = 0
  while (k <= dim(RNAse_Data)[1]){
    Protein_Sum = Protein_Sum + RNAse_Data[k,j]
    k = k + 3
  }
  Total_Protein[6,j]=Protein_Sum
}  

Total_Protein_Data = as.data.frame(Total_Protein)
colnames(Total_Protein_Data)=colnames(RNAse_Data)
rownames(Total_Protein_Data)=c("Ctrl_Rep1","Ctrl_Rep2","Ctrl_Rep3","RNAse_Rep1","RNAse_Rep2","RNAse_Rep3")

Total_Protein_Data
```
Barplot für die einzelnen Repetitions


```{r}
vec_25=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25)

for (i in 1:6) {
barplot_vector = as.numeric(Total_Protein_Data[i,])
names(barplot_vector) = vec_25
barplot(barplot_vector) 
}

```
Comparision of Ctrl group and RNAse um unterschiede zu finden, wo im RNAse dataset mehr als 1000 protein wo im Ctrl dataset mehr als 1000 protein, und dann vergleich ob dies an den selben stellen der fall ist.
```{r}
logic_ctrl <- Ctrl_Data > 1000
logic_RNAse <- RNAse_Data > 1000
logic_compare <- logic_ctrl == logic_RNAse
View(logic_compare)
```

```{r}
Total_Protein_Sum = rowSums(Total_Protein_Data) # Calculate the Total amount of all protein in one repetition
Total_Protein_Sum
barplot(Total_Protein_Sum)

RNAse_Data_norm = RNAse_Data
i = 1
while (i <= dim(RNAse_Data)[1]) {
  for (j in 1:25) { # Teile alle Fractions of Rep1 durch Rep1 total protein sum.
    RNAse_Data_norm[i,j] = RNAse_Data[i,j]/Total_Protein_Sum[4]
  }
  i = i+1
  
  for (j in 1:25) {# Teile alle Fractions of Rep2 durch Rep2 total protein sum.
    RNAse_Data_norm[i,j] = RNAse_Data[i,j]/Total_Protein_Sum[5]
  }
  i = i+1
  
  for (j in 1:25) {# Teile alle Fractions of Rep2 durch Rep2 total protein sum.
    RNAse_Data_norm[i,j] = RNAse_Data[i,j]/Total_Protein_Sum[4]
  }
  i = i+1
}

# Jetzt das selbe nochmal für Ctrl
Ctrl_Data_norm = Ctrl_Data
i = 1
while (i <= dim(Ctrl_Data)[1]) {
  for (j in 1:25) { # Teile alle Fractions of Rep1 durch Rep1 total protein sum.
    Ctrl_Data_norm[i,j] = Ctrl_Data[i,j]/Total_Protein_Sum[1]
  }
  i = i+1
  
  for (j in 1:25) {# Teile alle Fractions of Rep2 durch Rep2 total protein sum.
    Ctrl_Data_norm[i,j] = Ctrl_Data[i,j]/Total_Protein_Sum[2]
  }
  i = i+1
  
  for (j in 1:25) {# Teile alle Fractions of Rep2 durch Rep2 total protein sum.
    Ctrl_Data_norm[i,j] = Ctrl_Data[i,j]/Total_Protein_Sum[3]
  }
  i = i+1
}
```

