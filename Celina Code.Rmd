---
title: "Celina Code"
author: "Celina"
date: "1 5 2021"
output: html_document
---

```{r}

```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

Creating plot: total protein in control vs fraction, rep1= blue, rep2= red, rep3= blue
```{r}
Total_Prot_Rotated <- t(Total_Protein_Data)
Total_Prot_Rotated_df <- data.frame(Total_Prot_Rotated)
ggplot(Total_Prot_Rotated_df, aes(x=1:25))+
  geom_line(aes(y=Total_Prot_Rotated_df[,1]),colour="blue")+
  geom_line(aes(y=Total_Prot_Rotated_df[,2]), colour="red")+
  geom_line(aes(y=Total_Prot_Rotated_df[,3]), colour = "green")+
  ggtitle("Protein amounts in every Fraction (Ctlr)")+
  xlab("Fractions")+
  ylab("Total Protein Amount")+
  scale_x_continuous(breaks=1:25)
```
```
Determine the mean of the 2 most similar replicates

Instead of lof
```{r}

outlier.clean_func <- function(input) {
    new_clean_df <- as.data.frame(matrix(nrow = (dim(input)[1]/3), ncol = dim(input)[2])) ##Create the dataframe
    rownames(new_clean_df) <- rownames(Data_copy)
    colnames(new_clean_df) <- colnames(RNAse_Data_norm)


    i <- 1
    while (i <= dim(input)[1]) {          #i = rows
        for (j in 1:dim(input)[2]) {        # j = columns 
            x1 <- input[i,j]                  # 1. row, 1. column
            x2 <- input[i+1,j]                # 2. row 1. column
            x3 <- input[i+2,j]                # 3. row 1. column
            if( (abs(x1-x2)<abs(x1-x3)) && (abs(x1-x2)<abs(x2-x3)) ) {
                mean <- mean(c(x1,x2))
            } else if( (abs(x1-x3)<abs(x1-x2)) && (abs(x1-x3)<abs(x2-x3)) ) {
                mean <- mean(c(x1,x3))
            } else {
                mean <- mean(c(x2,x3))
            }
            new_clean_df[(i/3)+1,j] <- mean
        }
        i <- i + 3
    }
    return(new_clean_df)
}

Ctrl_new_clean_df= outlier.clean_func(Ctrl_Data_norm)
view(Ctrl_new_clean_df) 



```
    
Maxima detection
how to apply maxima function on our dataframe

diff wants a matrix or a vector rather than a data frame --> data.frame(diff(as.matrix(df)))


#difference function in R

	diff(c(2,3,5,18,4,6,4),lag=1)

diff() with lag=1 calculates difference between 2nd element and 1st element and then difference between 3rd element and 2nd element and so on.




sign R function returns the signs of numeric elements. The value 1 is returned for positive numbers, the value 0 is returned for zero, and the value -1 is returned for negative numbers


or maybe: row- wise max of a matrix
rowMaxs(x, value = FALSE)

```
```{r}

matrix_Ctrl_lof_df <- data.matrix(Ctrl_lof_df)
matrix_Ctrl_lof_df



##I have no clue yet but maybe something like this



#a peak is defined as a local maxima with m points either side of it being smaller than it. hence, the bigger the parameter m, the more stringent is the peak funding procedure

find_peaks <- function (x, m = 2){
    shape <- diff(sign(diff(x, na.pad = FALSE)))
    pks <- sapply(which(shape < 0), FUN = function(i){
       z <- i - m + 1
       z <- ifelse(z > 0, z, 1)
       w <- i + m + 1
       w <- ifelse(w < length(x), w, length(x))
       if(all(x[c(z : i, (i + 2) : w)] <= x[i + 1])) return(i + 1) else return(numeric(0))
    })
     pks <- unlist(pks)
     pks
}

Ctlr_Peaks <- find_peaks(Ctrl_lof_df)



```

